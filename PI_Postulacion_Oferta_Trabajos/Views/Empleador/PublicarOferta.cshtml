@model PI_Postulacion_Oferta_Trabajos.Models.Oferta

@{
    ViewData["Title"] = "Publicar Oferta";
    ViewBag.FormAction = "PublicarOferta"; // Acción del formulario
    ViewBag.SubmitButtonText = "Publicar Oferta"; // Texto del botón
}

<h2>Publicar Oferta</h2>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <form asp-action="@ViewBag.FormAction" method="post" class="bg-light p-4 rounded shadow-sm">
                <!--Este parte del código muestra los errores-->
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                <!-- Título de la oferta -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeTitulo" class="form-control" id="OfeTitulo" placeholder="Título de la oferta" />
                    <label for="OfeTitulo"><i class="bi bi-briefcase"></i> Título de la oferta</label>
                    <span asp-validation-for="OfeTitulo" class="text-danger"></span>
                </div>

                <!-- Descripción de la oferta -->
                <div class="form-floating mb-3">
                    <textarea asp-for="OfeDescripcion" class="form-control" id="OfeDescripcion" placeholder="Descripción de la oferta"></textarea>
                    <label for="OfeDescripcion"><i class="bi bi-file-text"></i> Descripción de la oferta</label>
                    <span asp-validation-for="OfeDescripcion" class="text-danger"></span>
                </div>

                <!-- Tipo de contrato -->
                <div class="form-floating mb-3">
                    <select asp-for="OfeTipoContrato" class="form-select" id="OfeTipoContrato">
                        <option value="">Seleccione un tipo de contrato</option>
                        <option value="Por horas">Por horas</option>
                        <option value="Medio tiempo">Medio tiempo</option>
                        <option value="Tiempo completo">Tiempo completo</option>
                        <option value="Temporal">Temporal</option>
                        <option value="Freelance">Freelance</option>
                        <option value="Pasantía">Pasantía</option>
                        <option value="Por obra o servicio">Por obra o servicio</option>
                    </select>
                    <label for="OfeTipoContrato"><i class="bi bi-calendar-check"></i> Tipo de contrato</label>
                    <span asp-validation-for="OfeTipoContrato" class="text-danger"></span>
                </div>

                <!-- Salario -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeSalario" class="form-control" id="OfeSalario" type="number" step="0.01" placeholder="Salario" />
                    <label for="OfeSalario"><i class="bi bi-cash"></i> Salario</label>
                    <span asp-validation-for="OfeSalario" class="text-danger"></span>
                </div>

                <!-- Cantidad de vacantes -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeCantidadVacantes" class="form-control" id="OfeCantidadVacantes" type="number" placeholder="Cantidad de vacantes" />
                    <label for="OfeCantidadVacantes"><i class="bi bi-person-fill"></i> Cantidad de vacantes</label>
                    <span asp-validation-for="OfeCantidadVacantes" class="text-danger"></span>
                </div>

                <!-- Tiempo de experiencia -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeTiempoExperiencia" class="form-control" id="OfeTiempoExperiencia" type="number" placeholder="Tiempo de experiencia (en años)" />
                    <label for="OfeTiempoExperiencia"><i class="bi bi-hourglass-split"></i> Tiempo de experiencia (en años)</label>
                    <span asp-validation-for="OfeTiempoExperiencia" class="text-danger"></span>
                </div>

                <!-- Educación mínima -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeEducacionMinima" class="form-control" id="OfeEducacionMinima" placeholder="Educación mínima requerida" />
                    <label for="OfeEducacionMinima"><i class="bi bi-mortarboard"></i> Educación mínima requerida</label>
                    <span asp-validation-for="OfeEducacionMinima" class="text-danger"></span>
                </div>

                <!-- Licencia -->
                <div class="form-check mb-3">
                    <input asp-for="OfeLicencia" class="form-check-input" type="checkbox" id="OfeLicencia" />
                    <label class="form-check-label" for="OfeLicencia"><i class="bi bi-card-checklist"></i> Licencia</label>
                </div>

                <!-- Disponibilidad para viajar -->
                <div class="form-check mb-3">
                    <input asp-for="OfeDisponibilidadViajar" class="form-check-input" type="checkbox" id="OfeDisponibilidadViajar" />
                    <label class="form-check-label" for="OfeDisponibilidadViajar"><i class="bi bi-travel"></i> Disponibilidad para viajar</label>
                </div>

                <!-- Disponibilidad para cambio de residencia -->
                <div class="form-check mb-3">
                    <input asp-for="OfeDisponibilidadCambioResidencia" class="form-check-input" type="checkbox" id="OfeDisponibilidadCambioResidencia" />
                    <label class="form-check-label" for="OfeDisponibilidadCambioResidencia"><i class="bi bi-house-door"></i> Disponibilidad para cambio de residencia</label>
                </div>

                <!-- Discapacidad -->
                <div class="form-check mb-3">
                    <input asp-for="OfeDiscapacidad" class="form-check-input" type="checkbox" id="OfeDiscapacidad" />
                    <label class="form-check-label" for="OfeDiscapacidad"><i class="bi bi-wheelchair"></i> Discapacidad</label>
                </div>

                <!-- Edad mínima -->
                <div class="form-floating mb-3">
                    <input asp-for="OfeEdadMinima" class="form-control" id="OfeEdadMinima" type="number" placeholder="Edad mínima" />
                    <label for="OfeEdadMinima"><i class="bi bi-calendar"></i> Edad mínima</label>
                    <span asp-validation-for="OfeEdadMinima" class="text-danger"></span>
                </div>

                <!-- Área laboral -->
                <div class="form-floating mb-3">
                    <select asp-for="ArlId" class="form-select" id="ArlId">
                        <option value="">Seleccione un área laboral</option>
                        @foreach (var area in ViewBag.AreasLaborales as List<PI_Postulacion_Oferta_Trabajos.Models.AreaLaboral>)
                        {
                            <option value="@area.ArlId">@area.ArlNombre</option>
                        }
                    </select>
                    <label for="ArlId"><i class="bi bi-geo-alt"></i> Área laboral</label>
                    <span asp-validation-for="ArlId" class="text-danger"></span>
                </div>

                <!-- Puesto laboral -->
                <div class="form-floating mb-3">
                    <select asp-for="PulId" class="form-select" id="PulId">
                        <option value="">Seleccione un puesto laboral</option>
                        @foreach (var puesto in ViewBag.PuestosLaborales as List<PI_Postulacion_Oferta_Trabajos.Models.PuestoLaboral>)
                        {
                            <option value="@puesto.PulId">@puesto.PulNombre</option>
                        }
                    </select>
                    <label for="PulId"><i class="bi bi-briefcase-fill"></i> Puesto laboral</label>
                    <span asp-validation-for="PulId" class="text-danger"></span>
                </div>

                <!-- Modalidad -->
                <div class="form-floating mb-3">
                    <select asp-for="OfmId" class="form-select" id="OfmId">
                        <option value="">Seleccione una modalidad</option>
                        @foreach (var modalidad in ViewBag.OfertaModalidades as List<PI_Postulacion_Oferta_Trabajos.Models.OfertaModalidad>)
                        {
                            <option value="@modalidad.OfmId">@modalidad.OfmNombre</option>
                        }
                    </select>
                    <label for="OfmId"><i class="bi bi-toggle-on"></i> Modalidad</label>
                    <span asp-validation-for="OfmId" class="text-danger"></span>
                </div>

                <!-- Provincia -->
                <div class="form-floating mb-3">
                    <select asp-for="ProId" class="form-select" id="ProId">
                        <option value="">Seleccione una provincia</option>
                        @foreach (var provincia in ViewBag.Provincias as List<PI_Postulacion_Oferta_Trabajos.Models.Provincia>)
                        {
                            <option value="@provincia.ProId">@provincia.ProNombre</option>
                        }
                    </select>
                    <label for="ProId"><i class="bi bi-geo-fill"></i> Provincia</label>
                    <span asp-validation-for="ProId" class="text-danger"></span>
                </div>

                <!-- Ciudad -->
                <div class="form-floating mb-3">
                    <select asp-for="CidId" class="form-select" id="CidId">
                        <option value="">Seleccione una ciudad</option>
                        @foreach (var ciudad in ViewBag.Ciudades as List<PI_Postulacion_Oferta_Trabajos.Models.Ciudad>)
                        {
                            <option value="@ciudad.CidId">@ciudad.CidNombre</option>
                        }
                    </select>
                    <label for="CidId"><i class="bi bi-building"></i> Ciudad</label>
                    <span asp-validation-for="CidId" class="text-danger"></span>
                </div>
                <button type="submit" class="btn btn-primary mt-3"><i class="bi bi-save"></i> @ViewBag.SubmitButtonText</button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <!-- Incluir aquí los scripts adicionales, como los métodos de filtro para dropdowns -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!--Método de filtro para puestos laborales-->
    <script>
        $(document).ready(function () {
            $('#ArlId').change(function () {
                var arlId = $(this).val();
                if (arlId) {
                    $.ajax({
                        url: '@Url.Action("GetPuestosLaborales", "AreasLaborales")',
                        type: 'GET',
                        data: { arlId: arlId },
                        success: function (data) {
                            var $pulId = $('#PulId');
                            $pulId.empty();
                            $pulId.append('<option value="">Seleccione un puesto</option>');
                            $.each(data, function (index, item) {
                                $pulId.append($('<option>').val(item.pulId).text(item.pulNombre));
                            });
                        }
                    });
                } else {
                    $('#PulId').empty();
                }
            });
        });
    </script>

    <!--Método de filtro para ciudades-->
    <script>
        $(document).ready(function () {
            $('#ProId').change(function () {
                var proId = $(this).val();
                if (proId) {
                    $.ajax({
                        url: '@Url.Action("GetCiudades", "Provincias")',
                        type: 'GET',
                        data: { proId: proId },
                        success: function (data) {
                            var $cidId = $('#CidId');
                            $cidId.empty();
                            $cidId.append('<option value="">Seleccione una ciudad</option>');
                            $.each(data, function (index, item) {
                                $cidId.append($('<option>').val(item.cidId).text(item.cidNombre));
                            });
                        }
                    });
                } else {
                    $('#CidId').empty().append('<option value="">Seleccione una ciudad</option>');
                }
            });
        });
    </script>
}

